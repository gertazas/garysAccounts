{% extends "base.html" %}

{% block title %}Step 2 - Percentages{% endblock %}

{% block content %}
    
<h1>Trailer Selection</h1>
<h1>Step 2: Percentages</h1>
{% if trailer_counts %}
    <p style="color: green;"><strong>Step 1 completed! Please fill in the details below.</strong></p>
{% else %}
    <p style="color: red;"><strong>Please complete Step 1 first.</strong></p>
{% endif %}
{% load custom_filters %}
<form method="post">
    {% csrf_token %}
    <table style="opacity: {% if trailer_counts %}1{% else %}0.5{% endif %};">
        <thead>
            <tr>
                <th>Day</th>
                <th>Trailer #</th>
                <th>Coffee %</th>
                <th>Milkshake %</th>
            </tr>
        </thead>
        <tbody>
            {% for day, count in trailer_counts.items %}
            {% for i in count|times %}
                <tr>
                    <td>{{ day }}</td>
                    <td>Trailer {{ i }}</td>
                    <td>
                        <input type="number" name="coffee_{{ day }}_{{ i }}" step="0.1" min="0" max="100" required 
                               {% if not trailer_counts %}disabled{% endif %}>
                    </td>
                    <td>
                        <input type="number" name="milkshake_{{ day }}_{{ i }}" step="0.1" min="0" max="100" required 
                               {% if not trailer_counts %}disabled{% endif %}>
                    </td>
                </tr>
            {% endfor %}
            {% endfor %}
        </tbody>
    </table>
    
    <button type="submit" {% if not trailer_counts %}disabled{% endif %}>Next</button>
</form>
<form method="get" class='mt-5 pt-5'>
    <button class='mt-5' type="submit" name="reset" style="background-color: rgb(151, 44, 44); color: white; border: none; padding: 10px 15px; cursor: pointer;">
        Reset & Start Over
    </button>
</form>
{% if not trailer_counts %}
<script>
    setTimeout(() => {
        window.location.href = "{% url 'trailer_selection' %}"; // Redirect to Step 1
    }, 3000);  // Redirect after 3 seconds
</script>
{% endif %}


<!-- <h1>Summary</h1>

<h3>Coffee % per Trailer</h3>
<ul>
    {% for coffee in coffee_data %}
    <li>{{ coffee }}%</li>
    {% endfor %}
</ul>

<h3>Milkshake % per Trailer</h3>
<ul>
    {% for milkshake in milkshake_data %}
    <li>{{ milkshake }}%</li>
    {% endfor %}
</ul>

<h3>Totals</h3>
<ul>
    <li>Total Coffee: {{ total_coffee }}%</li>
    <li>Total Milkshake: {{ total_milkshake }}%</li>
</ul> -->

{% endblock %}